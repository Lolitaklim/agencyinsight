<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Snake Blocks</title>
    <style>
      .grid-container {
        display: grid;
        margin-top: 5px;
        padding: 10px;
        gap: 10px;
        background: rgb(0, 150, 208);
        grid-template-rows: 60px 60px;
        grid-template-columns: 22% 22% 22% 22%;
      }

      .item {
        background-color: azure;
      }
    </style>
  </head>
  <body>
    <div class="grid-container" id="container"></div>
    <script>
      const slideTemplate = (
        href,
        imageUrl,
        altImage,
        title,
        description,
        cssClass
      ) => `
    <a href="${href}" class="${cssClass}">
      <div class="container_img">
        <img src="${SERVER_URL}/uploads/${imageUrl}" alt="${altImage}"/>
      </div>
        <p class="title">${title}</p>
        <p class="description">${description}</p>
    </a>
`
      function createSwiper(element) {
        const swiper = new Swiper(element, {
          modules: [Autoplay, Pagination],
          spaceBetween: 10,
          loop: true,
          autoplay: {
            delay: 4000,
            pauseOnMouseEnter: true,
          },
          pagination: {
            el: '.swiper-pagination',
            type: 'progressbar',
          },
        })
      }

      function slidesHtml(cssClass) {
        return state.dataNews
          .map((item) =>
            slideTemplate(
              `#${item.href}`,
              item.image_url,
              item.alt_image,
              item.title,
              item.description,
              cssClass
            )
          )
          .join('')
      }
      async function loadSwiperData(
        element,
        wrapper,
        script,
        cards = undefined
      ) {
        try {
          const response = await fetch(`${SERVER_URL}/api/${script}`)
          state.dataNews = await response.json()
          const swiperWrapper = document.getElementById(wrapper)

          swiperWrapper.innerHTML = slidesHtml('swiper-slide')
          if (cards) {
            const newsCards = document.getElementById(cards)
            newsCards.innerHTML = slidesHtml('card')
          }

          createSwiper(element)
        } catch (error) {
          console.error('Ошибка загрузки данных для Swiper:', error)
        }
      }
      loadSwiperData(
        '#newsSwiper',
        'newsSwiperWrapper',
        'get_homepage_news.php',
        'newsCards'
      )
      loadSwiperData(
        '#mainNewsSwiper',
        'mainNewsSwiperWrapper',
        'get_swiper_hero.php'
      )
    </script>
  </body>
</html>
